{"version":3,"sources":["game_scenes.js"],"names":["cc","Class","extends","Component","properties","cow_prefab","type","Prefab","default","onLoad","is_start","cow_set","checkout_root","find","checkout_src","getComponent","Label","time_src","cow_src","start_game","_on_timer","time_count","string","unscheduleAllCallbacks","active","cow_count","scheduleOnce","bind","console","log","setLocalZOrder","_gen_cow","remove_from_cow_set","cow","i","indexOf","splice","hit_cow","cow_type","length","x","y","removeFromParent","instantiate","node","addChild","push","Math","random","start","shoot_bt","getChildByName","rope"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,oBAAW;AACPC,kBAAMN,GAAGO,MADF;AAEPC,qBAAS;AAFF;;AAjBH,KAHP;;AA2BLC,YAAQ,kBAAU;AACd,aAAKC,QAAL,GAAgB,KAAhB;AACA,aAAKC,OAAL,GAAe,EAAf;;AAEA,aAAKC,aAAL,GAAqBZ,GAAGa,IAAH,CAAQ,uBAAR,CAArB;AACA,aAAKC,YAAL,GAAoBd,GAAGa,IAAH,CAAQ,qCAAR,EAA+CE,YAA/C,CAA4Df,GAAGgB,KAA/D,CAApB;AACA,aAAKC,QAAL,GAAgBjB,GAAGa,IAAH,CAAQ,cAAR,EAAwBE,YAAxB,CAAqCf,GAAGgB,KAAxC,CAAhB;AACA,aAAKE,OAAL,GAAelB,GAAGa,IAAH,CAAQ,mBAAR,EAA6BE,YAA7B,CAA0Cf,GAAGgB,KAA7C,CAAf;;AAEA,aAAKG,UAAL;AACH,KArCI;;AAuCLC,eAAW,qBAAU;AACjB,aAAKC,UAAL;AACA,aAAKJ,QAAL,CAAcK,MAAd,GAAuB,KAAK,KAAKD,UAAjC;;AAEA,YAAI,KAAKA,UAAL,IAAmB,CAAvB,EAA0B;AACtB,iBAAKE,sBAAL;AACA,iBAAKX,aAAL,CAAmBY,MAAnB,GAA4B,IAA5B;AACA,iBAAKV,YAAL,CAAkBQ,MAAlB,GAA2B,QAAQ,KAAKG,SAAxC;AACA,iBAAKf,QAAL,IAAiB,KAAjB;AACA;AACH;AACD,aAAKgB,YAAL,CAAkB,KAAKN,SAAL,CAAeO,IAAf,CAAoB,IAApB,CAAlB,EAA4C,CAA5C;AACH,KAnDI;;AAqDLR,gBAAY,sBAAU;;AAElBS,gBAAQC,GAAR,CAAY,MAAZ;AACA;AACA;AACA;;AAEA,aAAKjB,aAAL,CAAmBY,MAAnB,GAA4B,KAA5B;AACA,aAAKd,QAAL,GAAgB,IAAhB;AACA,aAAKe,SAAL,GAAiB,CAAjB;AACA,aAAKP,OAAL,CAAaI,MAAb,GAAsB,KAAK,KAAKG,SAAhC;;AAEA,aAAKJ,UAAL,GAAkB,EAAlB;AACA,aAAKJ,QAAL,CAAcK,MAAd,GAAuB,KAAK,KAAKD,UAAjC;AACA,aAAKT,aAAL,CAAmBkB,cAAnB,CAAkC,IAAlC;;AAEA,aAAKP,sBAAL;AACA,aAAKG,YAAL,CAAkB,KAAKN,SAAL,CAAeO,IAAf,CAAoB,IAApB,CAAlB,EAA4C,CAA5C;AACA,aAAKI,QAAL;AACH,KAxEI;;AA0ELC,yBAAqB,6BAASC,GAAT,EAAa;AAC9B,YAAIC,IAAI,KAAKvB,OAAL,CAAawB,OAAb,CAAqBF,GAArB,CAAR;AACA,aAAKtB,OAAL,CAAayB,MAAb,CAAoBF,CAApB,EAAsB,CAAtB;AACH,KA7EI;;AA+ELG,aAAS,mBAAU;AACf,YAAIC,WAAW,CAAC,CAAhB;AACA,aAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAI,KAAKvB,OAAL,CAAa4B,MAAjC,EAAyCL,GAAzC,EAA8C;AAC1C,gBAAI,KAAKvB,OAAL,CAAauB,CAAb,EAAgBM,CAAhB,IAAqB,EAArB,IAA2B,KAAK7B,OAAL,CAAauB,CAAb,EAAgBO,CAAhB,IAAqB,GAApD,EAAyD;;AAErDH,2BAAW,KAAK3B,OAAL,CAAauB,CAAb,EAAgBnB,YAAhB,CAA6B,KAA7B,EAAoCuB,QAA/C;AACA,qBAAK3B,OAAL,CAAauB,CAAb,EAAgBQ,gBAAhB;AACA,qBAAK/B,OAAL,CAAayB,MAAb,CAAoBF,CAApB,EAAsB,CAAtB;;AAEA,qBAAKT,SAAL;AACA,qBAAKP,OAAL,CAAaI,MAAb,GAAsB,KAAK,KAAKG,SAAhC;;AAEA,uBAAOa,QAAP;AACH;AACJ;AACD,eAAO,CAAC,CAAR;AACH,KA/FI;;AAiGLP,cAAU,oBAAU;AAChB,YAAIE,MAAMjC,GAAG2C,WAAH,CAAe,KAAKtC,UAApB,CAAV;AACA,aAAKuC,IAAL,CAAUC,QAAV,CAAmBZ,GAAnB;AACAA,YAAIT,MAAJ,GAAa,IAAb;AACAS,YAAIO,CAAJ,GAAQ,GAAR;AACAP,YAAIQ,CAAJ,GAAQ,CAAC,GAAT;AACA,aAAK9B,OAAL,CAAamC,IAAb,CAAkBb,GAAlB;AACA,aAAKP,YAAL,CAAkB,KAAKK,QAAL,CAAcJ,IAAd,CAAmB,IAAnB,CAAlB,EAA2CoB,KAAKC,MAAL,KAAgB,CAAhB,GAAoB,CAA/D;AACH,KAzGI;;AA2GLC,WAAM,iBAAU;AACZ,YAAIC,WAAW,KAAKN,IAAL,CAAUO,cAAV,CAAyB,cAAzB,CAAf;AACAD,iBAASpB,cAAT,CAAwB,IAAxB;;AAEA,YAAIsB,OAAO,KAAKR,IAAL,CAAUO,cAAV,CAAyB,MAAzB,CAAX;AACAC,aAAKtB,cAAL,CAAoB,IAApB;AACH;;AAjHI,CAAT","file":"game_scenes.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n\n        cow_prefab:{\n            type: cc.Prefab,\n            default: null,\n        },\n\n    },\n\n    onLoad: function(){\n        this.is_start = false;\n        this.cow_set = [];\n\n        this.checkout_root = cc.find(\"UI_ROOT/checkout_root\");\n        this.checkout_src = cc.find(\"UI_ROOT/checkout_root/bg_mask/score\").getComponent(cc.Label);\n        this.time_src = cc.find(\"UI_ROOT/time\").getComponent(cc.Label);\n        this.cow_src = cc.find(\"UI_ROOT/cow_count\").getComponent(cc.Label);\n\n        this.start_game();\n    },\n\n    _on_timer: function(){\n        this.time_count --;\n        this.time_src.string = \"\" + this.time_count;\n\n        if (this.time_count <= 0) {\n            this.unscheduleAllCallbacks();\n            this.checkout_root.active = true;\n            this.checkout_src.string = \"分数：\" + this.cow_count;\n            this.is_start == false;\n            return;\n        };\n        this.scheduleOnce(this._on_timer.bind(this),1);\n    },\n\n    start_game: function(){\n\n        console.log(\"测试开始\");\n        // if (this.is_start == true){\n        //     return;\n        // }\n\n        this.checkout_root.active = false;\n        this.is_start = true;\n        this.cow_count = 0;\n        this.cow_src.string = \"\" + this.cow_count;\n\n        this.time_count = 60;\n        this.time_src.string = \"\" + this.time_count;\n        this.checkout_root.setLocalZOrder(3000);\n\n        this.unscheduleAllCallbacks();\n        this.scheduleOnce(this._on_timer.bind(this),1);\n        this._gen_cow();\n    },\n\n    remove_from_cow_set: function(cow){\n        var i = this.cow_set.indexOf(cow);\n        this.cow_set.splice(i,1);\n    },\n\n    hit_cow: function(){\n        var cow_type = -1;\n        for (var i = 0; i < this.cow_set.length; i++) {\n            if (this.cow_set[i].x >= 70 && this.cow_set[i].y <= 130) {\n\n                cow_type = this.cow_set[i].getComponent(\"cow\").cow_type;\n                this.cow_set[i].removeFromParent();\n                this.cow_set.splice(i,1);\n\n                this.cow_count ++;\n                this.cow_src.string = \"\" + this.cow_count;\n\n                return cow_type;\n            }\n        }\n        return -1;\n    },\n\n    _gen_cow: function(){\n        var cow = cc.instantiate(this.cow_prefab);\n        this.node.addChild(cow);\n        cow.active = true;\n        cow.x = 640;\n        cow.y = -100;\n        this.cow_set.push(cow);\n        this.scheduleOnce(this._gen_cow.bind(this),Math.random() * 3 + 4);\n    },\n\n    start:function(){\n        var shoot_bt = this.node.getChildByName(\"shoot_action\");\n        shoot_bt.setLocalZOrder(2000);\n\n        var rope = this.node.getChildByName(\"rope\");\n        rope.setLocalZOrder(1000);\n    },\n    \n});\n\n\n\n\n\n\n\n\n\n"]}